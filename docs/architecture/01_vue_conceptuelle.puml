@startuml
!theme plain
skinparam backgroundColor white
skinparam defaultFontName Arial

title Architecture Hexagonale - Vue Conceptuelle

' Style
skinparam package {
  BackgroundColor<<Coeur>> #E3F2FD
  BackgroundColor<<Application>> #E8F5E9
  BackgroundColor<<Adapters>> #FFEBEE
  BackgroundColor<<Main>> #F3E5F5
  BorderColor #424242
  FontStyle bold
}

package "CŒUR MÉTIER" <<Coeur>> {
  package "Domaine" {
    [Entités]
    [Règles métier]
    note right of [Entités]
      Ticket, User, Status
      Logique métier pure
      ZERO dépendance externe
    end note
  }
  
  package "Ports" {
    interface "Interfaces\nabstraites" as ports
    note right of ports
      Contrats définis par le métier
      Ex: TicketRepository (ABC)
      Le métier dit "ce dont j'ai besoin"
    end note
  }
}

package "APPLICATION" <<Application>> {
  [Use Cases]
  note right of [Use Cases]
    CreateTicket, ListTickets...
    Orchestration métier
    Coordonne Domaine + Ports
  end note
}

package "ADAPTERS" <<Adapters>> {
  [API Web]
  [Persistance]
  note bottom of [Persistance]
    Implémentations concrètes
    Répondent aux besoins (Ports)
    du cœur métier
  end note
}

package "COMPOSITION ROOT" <<Main>> {
  [Câblage]
  note right of [Câblage]
    Instancie les adapters
    Injecte dans les use cases
  end note
}

' Relations
[Use Cases] --> [Entités] : orchestre
[Use Cases] --> [Règles métier] : applique
[Use Cases] --> ports : dépend de

[Persistance] ..|> ports : implémente
[API Web] --> [Use Cases] : appelle

[Câblage] --> [API Web] : configure
[Câblage] --> [Use Cases] : crée
[Câblage] --> [Persistance] : instancie

' Note explicative
note bottom
  **Architecture concentrique** : tout dépend du cœur métier
  
  Le CŒUR (Domaine + Ports) ne dépend de rien.
  Les Ports expriment les besoins du métier (interfaces).
  Les Adapters répondent à ces besoins (implémentations).
  
  **Flux d'exécution** : API → Use Cases → Domaine
  **Flux de dépendances** : Adapters → Application → CŒUR
end note

@enduml
