@startuml
!theme plain
skinparam backgroundColor white
skinparam defaultFontName Arial

title Architecture Hexagonale - Vue Conceptuelle

' Style
skinparam package {
  BackgroundColor<<Domain>> #E3F2FD
  BackgroundColor<<Application>> #E8F5E9
  BackgroundColor<<Ports>> #FFF9C4
  BackgroundColor<<Adapters>> #FFEBEE
  BackgroundColor<<Main>> #F3E5F5
  BorderColor #424242
  FontStyle bold
}

package "src/" {
  
  package "domain/" <<Domain>> {
    [Entités métier]
    note right
      Ticket, User, Status
      Logique métier pure
      ZERO dépendance externe
    end note
  }
  
  package "ports/" <<Ports>> {
    interface "Repositories\n(ABC)" as repos
    note right
      Ports sortants (driven)
      Interfaces abstraites
      Ex: TicketRepository
      Définit "quoi" sans "comment"
    end note
  }
  
  package "application/usecases/" <<Application>> {
    [Use Cases]
    note right
      CreateTicket, ListTickets...
      Orchestration
      Dépend des ports (DI)
    end note
  }
  
  package "adapters/" <<Adapters>> {
    package "api/" {
      [FastAPI\nRouter]
    }
    
    package "db/" {
      [SQLite\nRepository]
    }
  }
  
  package "main.py" <<Main>> {
    [Composition\nRoot]
    note right
      Instancie tout
      Injecte les dépendances
    end note
  }
}

' Relations
[Use Cases] --> [Entités métier] : utilise
[Use Cases] --> repos : dépend de

[SQLite\nRepository] ..|> repos : implémente

[FastAPI\nRouter] --> [Use Cases] : appelle

[Composition\nRoot] --> [FastAPI\nRouter] : configure
[Composition\nRoot] --> [Use Cases] : crée
[Composition\nRoot] --> [SQLite\nRepository] : instancie

' Note explicative
note bottom
  **Flux d'exécution** : API → Use Cases → Domaine
  **Dépendances** : Adapters → Ports ← Application → Domaine
  
  Le domaine ne connaît rien du monde extérieur.
  Les ports définissent les contrats que les adapters implémentent.
  main.py est le seul endroit où on câble tout ensemble.
end note

@enduml
